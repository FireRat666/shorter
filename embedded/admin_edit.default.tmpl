<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="color-scheme" content="dark">
    <link rel="stylesheet" type="text/css" href="/shorter.css">
    <script src="/js/admin.js" defer></script>
    <title>Edit Subdomain - {{.Domain}}</title>
</head>
<body>
    <div class="content">
        <div class="header">
            <h1>Edit Subdomain: {{.Domain}}</h1>
        </div>
        <div class="tos">
            <form class="admin-form" method="POST" action="/admin/edit?domain={{.Domain}}">
                <input type="hidden" name="action" value="update_config">
                <input type="hidden" name="subdomain" value="{{.Domain}}">

                <label for="link_len1_timeout">Timeout (Len 1):</label>
                <input type="text" id="link_len1_timeout" name="link_len1_timeout" class="inputbox" value="{{.Config.LinkLen1Timeout}}">
                <label for="link_len1_display">Display (Len 1):</label>
                <input type="text" id="link_len1_display" name="link_len1_display" class="inputbox" value="{{.Config.LinkLen1Display}}">

                <label for="link_len2_timeout">Timeout (Len 2):</label>
                <input type="text" id="link_len2_timeout" name="link_len2_timeout" class="inputbox" value="{{.Config.LinkLen2Timeout}}">
                <label for="link_len2_display">Display (Len 2):</label>
                <input type="text" id="link_len2_display" name="link_len2_display" class="inputbox" value="{{.Config.LinkLen2Display}}">

                <label for="link_len3_timeout">Timeout (Len 3):</label>
                <input type="text" id="link_len3_timeout" name="link_len3_timeout" class="inputbox" value="{{.Config.LinkLen3Timeout}}">
                <label for="link_len3_display">Display (Len 3):</label>
                <input type="text" id="link_len3_display" name="link_len3_display" class="inputbox" value="{{.Config.LinkLen3Display}}">

                <label for="custom_timeout">Timeout (Custom):</label>
                <input type="text" id="custom_timeout" name="custom_timeout" class="inputbox" value="{{.Config.CustomTimeout}}">
                <label for="custom_display">Display (Custom):</label>
                <input type="text" id="custom_display" name="custom_display" class="inputbox" value="{{.Config.CustomDisplay}}">

                <label for="max_uses">Max Uses:</label>
                <input type="number" id="max_uses" name="max_uses" class="inputbox" value="{{.Config.LinkAccessMaxNr}}" min="0">

                <input type="submit" value="Update Subdomain" class="admin-submit-button">
            </form>
            <a href="/admin" style="display: block; margin-top: 1em;">Back to Admin Panel</a>
        </div>

        <div class="tos">
            <h2>Manage Static Links</h2>
            {{if .Config.StaticLinks}}
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Destination URL</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range $key, $url := .Config.StaticLinks}}
                        <tr>
                            <td>{{$key}}</td>
                            <td>{{$url}}</td>
                            <td>
                                <form method="POST" action="/admin/edit?domain={{$.Domain}}">
                                    <input type="hidden" name="action" value="delete_static_link">
                                    <input type="hidden" name="static_key" value="{{$key}}">
                                    <input type="submit" value="Delete" class="delete-button" data-confirm="Are you sure you want to delete this static link?">
                                </form>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            {{end}}
            <h3 style="margin-top: 2em;">Add New Static Link</h3>
            <form class="admin-form" method="POST" action="/admin/edit?domain={{.Domain}}">
                <input type="hidden" name="action" value="add_static_link">
                <label for="new_static_key">Key:</label>
                <input type="text" id="new_static_key" name="new_static_key" class="inputbox" required>
                <label for="new_static_url">Destination URL:</label>
                <input type="text" id="new_static_url" name="new_static_url" class="inputbox" required>
                <input type="submit" value="Add Static Link" class="admin-submit-button">
            </form>
        </div>

        <div class="tos">
            <h2>Active Links &amp; Text Dumps</h2>
            {{if .Links}}
                <table>
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Type</th>
                            <th>Expires At</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Links}}
                        <tr>
                            <td><a href="/{{.Key}}" target="_blank">{{.Key}}</a></td>
                            <td>{{.LinkType}}</td>
                            <td>{{.ExpiresAt.Format "2006-01-02 15:04 MST"}}</td>
                            <td>
                                <form method="POST" action="/admin/edit?domain={{$.Domain}}">
                                    <input type="hidden" name="action" value="delete_dynamic_link">
                                    <input type="hidden" name="link_key" value="{{.Key}}">
                                    <input type="submit" value="Delete" class="delete-button" data-confirm="Are you sure you want to delete this link?">
                                </form>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            {{else}}
                <p>No active links or text dumps found for this domain.</p>
            {{end}}
        </div>
    </div>
</body>
</html>